"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[135],{65446:function(mn,q,o){o.r(q),o.d(q,{default:function(){return un}});var ue=o(15009),D=o.n(ue),ge=o(97857),w=o.n(ge),me=o(99289),Y=o.n(me),fe=o(5574),_=o.n(fe),ee=o(56211),ve=o(87547),J=o(94149),z=o(1413),d=o(67294),pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},he=pe,ye=o(91146),xe=function(n,r){return d.createElement(ye.Z,(0,z.Z)((0,z.Z)({},n),{},{ref:r,icon:he}))},Se=d.forwardRef(xe),ne=Se,Ce=o(91),je=o(10915),Ie=o(28459),be=o(93967),G=o.n(be),$e=o(34994),k=o(4942),Pe=o(98082),Ze=function(n){return(0,k.Z)((0,k.Z)({},n.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:n.colorTextSecondary,fontSize:n.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),"@media (min-width: @screen-md-min)",(0,k.Z)({},"".concat(n.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}))};function Ee(e){return(0,Pe.Xj)("LoginForm",function(n){var r=(0,z.Z)((0,z.Z)({},n),{},{componentCls:".".concat(e)});return[Ze(r)]})}var l=o(85893),Ne=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function Ae(e){var n,r=e.logo,s=e.message,a=e.contentStyle,v=e.title,p=e.subTitle,h=e.actions,y=e.children,S=e.containerStyle,$=e.otherStyle,i=(0,Ce.Z)(e,Ne),E=(0,je.YB)(),O=i.submitter===!1?!1:(0,z.Z)((0,z.Z)({searchConfig:{submitText:E.getMessage("loginForm.submitText","\u767B\u5F55")}},i.submitter),{},{submitButtonProps:(0,z.Z)({size:"large",style:{width:"100%"}},(n=i.submitter)===null||n===void 0?void 0:n.submitButtonProps),render:function(g,C){var f,t=C.pop();if(typeof(i==null||(f=i.submitter)===null||f===void 0?void 0:f.render)=="function"){var u,x;return i==null||(u=i.submitter)===null||u===void 0||(x=u.render)===null||x===void 0?void 0:x.call(u,g,C)}return t}}),m=(0,d.useContext)(Ie.ZP.ConfigContext),L=m.getPrefixCls("pro-form-login"),N=Ee(L),R=N.wrapSSR,F=N.hashId,b=function(g){return"".concat(L,"-").concat(g," ").concat(F)},j=(0,d.useMemo)(function(){return r?typeof r=="string"?(0,l.jsx)("img",{src:r}):r:null},[r]);return R((0,l.jsxs)("div",{className:G()(b("container"),F),style:S,children:[(0,l.jsxs)("div",{className:"".concat(b("top")," ").concat(F).trim(),children:[v||j?(0,l.jsxs)("div",{className:"".concat(b("header")),children:[j?(0,l.jsx)("span",{className:b("logo"),children:j}):null,v?(0,l.jsx)("span",{className:b("title"),children:v}):null]}):null,p?(0,l.jsx)("div",{className:b("desc"),children:p}):null]}),(0,l.jsxs)("div",{className:b("main"),style:(0,z.Z)({width:328},a),children:[(0,l.jsxs)($e.A,(0,z.Z)((0,z.Z)({isKeyPressSubmit:!0},i),{},{submitter:O,children:[s,y]})),h?(0,l.jsx)("div",{className:b("main-other"),style:$,children:h}):null]})]}))}var H=o(5966),T=o(35312),Be=o(76278),Me=o(17012),ze=o(84481),Oe=o(29950),Te=o(1558),Le=o(82225),we=o(42550),He=o(64217),Fe=o(96159),De=o(53124),oe=o(54548),Re=o(14747),We=o(91945);const X=(e,n,r,s,a)=>({background:e,border:`${(0,oe.bf)(s.lineWidth)} ${s.lineType} ${n}`,[`${a}-icon`]:{color:r}}),Ue=e=>{const{componentCls:n,motionDurationSlow:r,marginXS:s,marginSM:a,fontSize:v,fontSizeLG:p,lineHeight:h,borderRadiusLG:y,motionEaseInOutCirc:S,withDescriptionIconSize:$,colorText:i,colorTextHeading:E,withDescriptionPadding:O,defaultPadding:m}=e;return{[n]:Object.assign(Object.assign({},(0,Re.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:m,wordWrap:"break-word",borderRadius:y,[`&${n}-rtl`]:{direction:"rtl"},[`${n}-content`]:{flex:1,minWidth:0},[`${n}-icon`]:{marginInlineEnd:s,lineHeight:0},["&-description"]:{display:"none",fontSize:v,lineHeight:h},"&-message":{color:E},[`&${n}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${r} ${S}, opacity ${r} ${S},
        padding-top ${r} ${S}, padding-bottom ${r} ${S},
        margin-bottom ${r} ${S}`},[`&${n}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${n}-with-description`]:{alignItems:"flex-start",padding:O,[`${n}-icon`]:{marginInlineEnd:a,fontSize:$,lineHeight:0},[`${n}-message`]:{display:"block",marginBottom:s,color:E,fontSize:p},[`${n}-description`]:{display:"block",color:i}},[`${n}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},Ve=e=>{const{componentCls:n,colorSuccess:r,colorSuccessBorder:s,colorSuccessBg:a,colorWarning:v,colorWarningBorder:p,colorWarningBg:h,colorError:y,colorErrorBorder:S,colorErrorBg:$,colorInfo:i,colorInfoBorder:E,colorInfoBg:O}=e;return{[n]:{"&-success":X(a,s,r,e,n),"&-info":X(O,E,i,e,n),"&-warning":X(h,p,v,e,n),"&-error":Object.assign(Object.assign({},X($,S,y,e,n)),{[`${n}-description > pre`]:{margin:0,padding:0}})}}},Ge=e=>{const{componentCls:n,iconCls:r,motionDurationMid:s,marginXS:a,fontSizeIcon:v,colorIcon:p,colorIconHover:h}=e;return{[n]:{["&-action"]:{marginInlineStart:a},[`${n}-close-icon`]:{marginInlineStart:a,padding:0,overflow:"hidden",fontSize:v,lineHeight:(0,oe.bf)(v),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${r}-close`]:{color:p,transition:`color ${s}`,"&:hover":{color:h}}},"&-close-text":{color:p,transition:`color ${s}`,"&:hover":{color:h}}}}},Xe=e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`});var Ke=(0,We.I$)("Alert",e=>[Ue(e),Ve(e),Ge(e)],Xe),te=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)n.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r};const Qe={success:Be.Z,info:Te.Z,error:Me.Z,warning:Oe.Z},Ye=e=>{const{icon:n,prefixCls:r,type:s}=e,a=Qe[s]||null;return n?(0,Fe.wm)(n,d.createElement("span",{className:`${r}-icon`},n),()=>({className:G()(`${r}-icon`,{[n.props.className]:n.props.className})})):d.createElement(a,{className:`${r}-icon`})},Je=e=>{const{isClosable:n,prefixCls:r,closeIcon:s,handleClose:a,ariaProps:v}=e,p=s===!0||s===void 0?d.createElement(ze.Z,null):s;return n?d.createElement("button",Object.assign({type:"button",onClick:a,className:`${r}-close-icon`,tabIndex:0},v),p):null};var re=d.forwardRef((e,n)=>{const{description:r,prefixCls:s,message:a,banner:v,className:p,rootClassName:h,style:y,onMouseEnter:S,onMouseLeave:$,onClick:i,afterClose:E,showIcon:O,closable:m,closeText:L,closeIcon:N,action:R,id:F}=e,b=te(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[j,I]=d.useState(!1),g=d.useRef(null);d.useImperativeHandle(n,()=>({nativeElement:g.current}));const{getPrefixCls:C,direction:f,alert:t}=d.useContext(De.E_),u=C("alert",s),[x,W,U]=Ke(u),A=c=>{var M;I(!0),(M=e.onClose)===null||M===void 0||M.call(e,c)},P=d.useMemo(()=>e.type!==void 0?e.type:v?"warning":"info",[e.type,v]),B=d.useMemo(()=>typeof m=="object"&&m.closeIcon||L?!0:typeof m=="boolean"?m:N!==!1&&N!==null&&N!==void 0?!0:!!(t!=null&&t.closable),[L,N,m,t==null?void 0:t.closable]),Z=v&&O===void 0?!0:O,K=G()(u,`${u}-${P}`,{[`${u}-with-description`]:!!r,[`${u}-no-icon`]:!Z,[`${u}-banner`]:!!v,[`${u}-rtl`]:f==="rtl"},t==null?void 0:t.className,p,h,U,W),V=(0,He.Z)(b,{aria:!0,data:!0}),Q=d.useMemo(()=>{var c,M;return typeof m=="object"&&m.closeIcon?m.closeIcon:L||(N!==void 0?N:typeof(t==null?void 0:t.closable)=="object"&&(!((c=t==null?void 0:t.closable)===null||c===void 0)&&c.closeIcon)?(M=t==null?void 0:t.closable)===null||M===void 0?void 0:M.closeIcon:t==null?void 0:t.closeIcon)},[N,m,L,t==null?void 0:t.closeIcon]),ce=d.useMemo(()=>{const c=m!=null?m:t==null?void 0:t.closable;if(typeof c=="object"){const{closeIcon:M}=c;return te(c,["closeIcon"])}return{}},[m,t==null?void 0:t.closable]);return x(d.createElement(Le.ZP,{visible:!j,motionName:`${u}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:c=>({maxHeight:c.offsetHeight}),onLeaveEnd:E},(c,M)=>{let{className:de,style:gn}=c;return d.createElement("div",Object.assign({id:F,ref:(0,we.sQ)(g,M),"data-show":!j,className:G()(K,de),style:Object.assign(Object.assign(Object.assign({},t==null?void 0:t.style),y),gn),onMouseEnter:S,onMouseLeave:$,onClick:i,role:"alert"},V),Z?d.createElement(Ye,{description:r,icon:e.icon,prefixCls:u,type:P}):null,d.createElement("div",{className:`${u}-content`},a?d.createElement("div",{className:`${u}-message`},a):null,r?d.createElement("div",{className:`${u}-description`},r):null),R?d.createElement("div",{className:`${u}-action`},R):null,d.createElement(Je,{isClosable:B,prefixCls:u,closeIcon:Q,handleClose:A,ariaProps:ce}))}))}),ke=o(15671),qe=o(43144),_e=o(53640),en=o(60136),nn=function(e){function n(){var r;return(0,ke.Z)(this,n),r=(0,_e.Z)(this,n,arguments),r.state={error:void 0,info:{componentStack:""}},r}return(0,en.Z)(n,e),(0,qe.Z)(n,[{key:"componentDidCatch",value:function(s,a){this.setState({error:s,info:a})}},{key:"render",value:function(){const{message:s,description:a,id:v,children:p}=this.props,{error:h,info:y}=this.state,S=y&&y.componentStack?y.componentStack:null,$=typeof s=="undefined"?(h||"").toString():s,i=typeof a=="undefined"?S:a;return h?d.createElement(re,{id:v,type:"error",message:$,description:d.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},i)}):p}}])}(d.Component);const le=re;le.ErrorBoundary=nn;var on=le,se=o(2453),tn=o(31284),rn=o(71230),ae=o(15746),ln=o(67610),sn=o(73935),an=o(6189),cn=(0,an.kc)(function(e){var n=e.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:n.colorPrimaryActive}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"},main:{padding:"0px !important",margin:"10px"}}}),ie=function(n){var r=n.content;return(0,l.jsx)(on,{style:{marginBottom:24},message:r,type:"error",showIcon:!0})},dn=function(){var n,r=(0,d.useState)({}),s=_()(r,2),a=s[0],v=s[1],p=(0,d.useState)("sign-in"),h=_()(p,2),y=h[0],S=h[1],$=(0,T.useModel)("@@initialState"),i=$.initialState,E=$.setInitialState,O=cn(),m=O.styles,L=(0,T.useIntl)(),N=function(){var j=Y()(D()().mark(function I(){var g,C;return D()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("auth - fetchUserInfo"),t.next=3,i==null||(g=i.fetchUserInfo)===null||g===void 0?void 0:g.call(i);case 3:C=t.sent,console.log("auth - userInfo"),console.log(C),C?(console.log("auth - userInfo - case - 01"),(0,sn.flushSync)(function(){console.log("auth - userInfo - case - 02"),E(function(u){return w()(w()({},u),{},{currentUser:C})})})):console.log("auth - userInfo - case - 03"),console.log("auth - initialState"),console.log(i);case 9:case"end":return t.stop()}},I)}));return function(){return j.apply(this,arguments)}}(),R=function(){var j=Y()(D()().mark(function I(g){var C,f,t,u,x,W,U,A,P,B,Z,K,V,Q;return D()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(console.log("handleSubmit"),console.log("values"),console.log(g),c.prev=3,x="",!((g==null||(C=g.name)===null||C===void 0?void 0:C.length)>0)){c.next=16;break}return g.name=g.first_name+" "+g.last_name,g.role="user",c.next=10,(0,ee.z2)(w()(w()({},g),{},{type:y}));case 10:W=c.sent,console.log("register_api_response"),console.log(W),x=W,c.next=22;break;case 16:return c.next=18,(0,ee.x4)(w()(w()({},g),{},{type:y}));case 18:U=c.sent,console.log("login_api_response"),console.log(U),x=U;case 22:if(localStorage.setItem("laravel_api_bearer_token",(f=x)===null||f===void 0||(f=f.data)===null||f===void 0?void 0:f.access_token),console.log("after - redirect - logged_user_api_response?.data?.user"),console.log((t=x)===null||t===void 0||(t=t.data)===null||t===void 0?void 0:t.user),E(w()(w()({},i),{},{currentUser:(u=x)===null||u===void 0||(u=u.data)===null||u===void 0?void 0:u.user,refresh:function(){return!0}})),console.log("before - redirect - initialState"),console.log(i),x.status!==!0){c.next=41;break}return K="login successful!",se.ZP.success(K),V=new URL(window.location.href).searchParams,T.history.push(V.get("redirect")||"/"+((A=x)===null||A===void 0||(A=A.data)===null||A===void 0||(A=A.user)===null||A===void 0?void 0:A.role)+"-app/",{initialState:i}),T.history.replace(V.get("redirect")||"/"+((P=x)===null||P===void 0||(P=P.data)===null||P===void 0||(P=P.user)===null||P===void 0?void 0:P.role)+"-app/",{initialState:i}),T.history.push("/"+((B=x)===null||B===void 0||(B=B.data)===null||B===void 0||(B=B.user)===null||B===void 0?void 0:B.role)+"-app/"),T.history.replace("/"+((Z=x)===null||Z===void 0||(Z=Z.data)===null||Z===void 0||(Z=Z.user)===null||Z===void 0?void 0:Z.role)+"-app/"),console.log("after - redirect - initialState"),console.log(i),c.abrupt("return");case 41:return T.history.push("/authentication"),T.history.replace("/authentication"),c.abrupt("return");case 44:c.next=51;break;case 46:c.prev=46,c.t0=c.catch(3),Q="Login failed, please try again!",console.log(c.t0),se.ZP.error(Q);case 51:case"end":return c.stop()}},I,null,[[3,46]])}));return function(g){return j.apply(this,arguments)}}(),F=a.status,b=a.type;return(0,l.jsxs)("div",{className:m==null?void 0:m.container,children:[(0,l.jsx)(T.Helmet,{children:(0,l.jsx)("title",{children:ln.Z.title})}),(0,l.jsx)("div",{style:{flex:"1"},children:(0,l.jsxs)(Ae,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,l.jsx)("img",{alt:"logo",src:i==null||(n=i.settings)===null||n===void 0?void 0:n.logo}),title:"TravelMates - 02",subTitle:"Your ultimate travel companion management app.",onFinish:function(){var j=Y()(D()().mark(function I(g){return D()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,R(g);case 2:case"end":return f.stop()}},I)}));return function(I){return j.apply(this,arguments)}}(),children:[(0,l.jsx)(tn.Z,{activeKey:y,onChange:S,centered:!0,items:[{key:"sign-in",label:"Sign in"},{key:"sign-up",label:"Sign Up"}]}),F==="error"&&b==="sign-in"&&(0,l.jsx)(ie,{content:"Wrong username or password"}),y==="sign-in"&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(H.Z,{name:"email",fieldProps:{size:"large",prefix:(0,l.jsx)(ve.Z,{})},placeholder:"username: admin or user",rules:[{required:!0,message:"please enter user name!"}]}),(0,l.jsx)(H.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,l.jsx)(J.Z,{}),max:10,min:6},placeholder:"password: ant.design",rules:[{required:!0,message:"Please enter your password!"}]})]}),F==="error"&&b==="sign-up"&&(0,l.jsx)(ie,{content:"Verification code error"}),y==="sign-up"&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(rn.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,l.jsx)(ae.Z,{span:12,children:(0,l.jsx)(H.Z,{name:"first_name",label:"First Name:",placeholder:"please enter your first name",rules:[{required:!0,message:"Please enter your first name!"}]})}),(0,l.jsx)(ae.Z,{span:12,children:(0,l.jsx)(H.Z,{name:"last_name",label:"Last Name:",placeholder:"please enter your last name",rules:[{required:!0,message:"Please enter your last name!"}]})})]}),(0,l.jsx)(H.Z,{fieldProps:{size:"large",prefix:(0,l.jsx)(ne,{})},name:"name",placeholder:"Name",rules:[{required:!0,message:"Please enter name!"}]}),(0,l.jsx)(H.Z,{fieldProps:{size:"large",prefix:(0,l.jsx)(ne,{})},name:"email",placeholder:"Email",rules:[{required:!0,message:"Please enter email!"}]}),(0,l.jsx)(H.Z.Password,{fieldProps:{size:"large",prefix:(0,l.jsx)(J.Z,{}),max:10,min:6},name:"password",placeholder:"Password",rules:[{required:!0,message:"Please enter password!"}]}),(0,l.jsx)(H.Z.Password,{name:"password_confirmation",dependencies:["password"],fieldProps:{size:"large",prefix:(0,l.jsx)(J.Z,{}),max:10,min:6},placeholder:"password: ant.design",rules:[{required:!0,message:"Please confirm your password!"},function(j){var I=j.getFieldValue;return{validator:function(C,f){return!f||I("password")===f?Promise.resolve():Promise.reject(new Error("The new password that you entered do not match!"))}}}]})]}),(0,l.jsx)("div",{style:{marginBottom:24}})]})})]})},un=dn}}]);
